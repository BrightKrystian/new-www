{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/android-manifest-placeholders","result":{"data":{"markdownRemark":{"html":"<h1>What are they?</h1>\n<p><a href=\"https://developer.android.com/studio/build/manifest-build-variables.html\">Android Manifest placeholders</a> allow you to put variables into the Manifest that is otherwise completely static. Why would you need such functionality? Actually, it depends on your projects. It's probably most useful when you have multiple <a href=\"https://developer.android.com/studio/build/build-variants.html\">build variants</a> with different Manifest configurations.</p>\n<h1>Multiple Manifests</h1>\n<p>Of course, the easiest way to configure Manifest per build variant is to place a separate <code>AndroidManifest.xml</code> file in the variant-specific source directory. For example let's say we have an <code>app</code> module with <a href=\"https://developer.android.com/studio/build/build-variants.html#flavor-dimensions\">flavor dimension</a> called <code>features</code> with two flavors: <code>paid</code> and <code>free</code>. In Gradle file it could look like this:</p>\n<pre><code class=\"language-groovy\">android {\n    ...\n    buildTypes {\n        release {...}\n        debug {...}\n    }\n\n    flavorDimensions \"features\"\n\n    productFlavors {\n        paid {\n            dimension \"features\"\n            ...\n        }\n        free {\n            dimension \"features\"\n            ...\n        }\n    }\n}\n</code></pre>\n<p>This enables us to use different source sets, including Manifest files. If we would like to separate <code>paid</code> and <code>free</code> configurations, we could place different Manifests in the following project directories:</p>\n<ul>\n<li><code>app/src/paid/AndroidManifest.xml</code></li>\n<li><code>app/src/free/AndroidManifest.xml</code></li>\n</ul>\n<p>We could also use fully qualified build variants (combining product flavors with build types):</p>\n<ul>\n<li><code>app/src/paidDebug/AndroidManifest.xml</code></li>\n<li><code>app/src/paidRelease/AndroidManifest.xml</code></li>\n<li><code>app/src/freeDebug/AndroidManifest.xml</code></li>\n<li><code>app/src/freeRelease/AndroidManifest.xml</code></li>\n</ul>\n<p><em>Note #1: Source sets are not created automatically. You can create them by hand or using <strong>Source set</strong> dropdown menu while creating a new file or directory in Android Studio.</em></p>\n<p><em>Note #2: If you would like to make sure how to organize the source sets, you can run Gradle <code>sourceSets</code> task, e.g. with <code>./gradlew sourceSets</code> or Android Studio Gradle menu.</em></p>\n<p>While using multiple Manifest files gives the best flexibility (you can change literally everything), the maintenance may be troublesome for several reasons, e.g.:</p>\n<ul>\n<li>changing anything requires editing every file,</li>\n<li>comparing multiple files and finding differences is not convenient.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/48f62a76ed11807e32a1e1117acb6660/5a190/placeholder.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAClUlEQVQ4y31UV1eTQRD9fqFHUSRiQRBRsXFEVBQ7KhBSgJACgZjQBYEgCIiihJJKCukJ+Feu587yRV70Yc7uzs7O3rl3djXv/gPMHryGM9yEkegdeGL34Yu3wbvfCkfoGoYiN+EMX4cz1Ah7qAHWnQvo2639p2mTyXasFm1YzluwUrBiJW/Feskh8+nUc/izPfha6Efg9xjGE49h2j4nSS07Bhl1YzKOmnn7PCw7NSc2DWK6z7Z3Bb79VkFP/2CwXnz2YAP6dy9VkjFeEOpQGdwbOCsbuhkDZ4SCH4du+HNGQb9WtGGtOIhfR17MpF4of6EPG2UXFjIfVEJ181XMpd9iONIsfI1E72I0dg9j8Ta4o7dl7om1wBW+IWtHqBG2vTrh2RVuwqeDV3JOU3zUSOCXnAlrRbsg4a2rxQFslIckeCb1UvZ/HnkEoaLFUKlGp04SLma7JWgi8URK+JzuFFEWsl1SMruASWfTb6QKcqeouoj+iimfxsVw5JYoSk6mUh2YSnZIgsnkU/jiD8XHNbuBB6k0EdHIO80YqPqLkBMG9WydRvfWKfQGqmROURazXVjKmTCd6sBSrlfQr5fsUgl7lVXwMlbpjjSrhHq7fIy1YCr5DPZgvXBKYYicicghDzIxK5lItMv+eOKRJCNFFFYb2LssahEhG/dbyVkRRG8TomHp85n30uSbR6OiPsvkOSVKtSqZJFM5QvfnerCcN4uyTEgOWTITEQEv5OV8rqqRlSB9FauFxs7nK2AQS6aqnLMcvmOu59KdgpKxeoswEWlS4lTDRITbNdAsx046zCeMBykOS9s8HMV85p1wReRsse9lt/DI10E//wJyq/3v56DZgnXSVjp69WLU6Dr+ofg7MSFf2R+fWlbOOG9PbwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Placeholder\"\n        title=\"Placeholder\"\n        src=\"/static/48f62a76ed11807e32a1e1117acb6660/fcda8/placeholder.png\"\n        srcset=\"/static/48f62a76ed11807e32a1e1117acb6660/12f09/placeholder.png 148w,\n/static/48f62a76ed11807e32a1e1117acb6660/e4a3f/placeholder.png 295w,\n/static/48f62a76ed11807e32a1e1117acb6660/fcda8/placeholder.png 590w,\n/static/48f62a76ed11807e32a1e1117acb6660/5a190/placeholder.png 800w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>{: .center-image}</p>\n<h1>Using placeholders</h1>\n<p>So instead of using multiple files I always strive to use some variables. In order to use a variable in the Manifest we must specify it in the <code>manifestPlaceholders</code> property in Gradle. We can do this in several places, e.g.:</p>\n<ul>\n<li>default config</li>\n</ul>\n<pre><code class=\"language-groovy\">android {\n    ...\n    defaultConfig {\n        manifestPlaceholders.screenOrientation = \"unspecified\"\n    }\n}\n</code></pre>\n<ul>\n<li>product flavor</li>\n</ul>\n<pre><code class=\"language-groovy\">android {\n    ...\n    flavorDimensions \"features\"\n\n    productFlavors {\n        paid {\n            dimension \"features\"\n            manifestPlaceholders.hostName = \"www.paid-example.com\"\n        }\n        free {\n            dimension \"features\"\n            manifestPlaceholders.hostName = \"www.free-example.com\"\n        }\n    }\n}\n</code></pre>\n<ul>\n<li>build type</li>\n</ul>\n<pre><code class=\"language-groovy\">android {\n    ...\n    buildTypes {\n        release {\n            ...\n            manifestPlaceholders.screenOrientation = \"portrait\"\n        }\n        debug {...}\n    }\n}\n</code></pre>\n<p><em>Note #1: <code>manifestPlaceholders</code> object is just a <code>Map&#x3C;String, Object></code> so you can also use its other methods like <code>containsKey()</code> etc.</em></p>\n<p><em>Note #2: You can also specify all the values at once by assigning a map like this: <code>manifestPlaceholders = [...]</code></em></p>\n<p>Then we can use the variables in the Manifest simply by putting the variable name in curly brackets and using a dollar sign like this:</p>\n<pre><code class=\"language-xml\">&#x3C;activity\n    android:name=\".MyActivity\"\n    android:screenOrientation=\"${screenOrientation}\" />\n</code></pre>\n<h1>Applications</h1>\n<p>I've come across a few common usages of the placeholders, e.g.:</p>\n<ul>\n<li>enabling/disabling <a href=\"https://developer.android.com/guide/components/.html\">application components</a> and meta-data, including the ones that come with your app's dependencies</li>\n</ul>\n<pre><code class=\"language-xml\">&#x3C;service\n    android:name=\".firebase.FcmIdService\"\n    android:enabled=\"${pushNotifications}\">\n    ...\n&#x3C;/service>\n\n&#x3C;provider\n    android:name=\"android.support.v4.content.FileProvider\"\n    android:authorities=\"${fileProvider}\"\n    ... >\n    ...\n&#x3C;/provider>\n</code></pre>\n<ul>\n<li>overriding screen orientation in portrait-only apps so that you can rotate it in debug builds which may be useful when looking for lifecycle related memory leaks</li>\n</ul>\n<pre><code class=\"language-xml\">&#x3C;activity\n    android:name=\".MyActivity\"\n    android:screenOrientation=\"${screenOrientation}\" />\n</code></pre>\n<ul>\n<li>using different deep links configuration</li>\n</ul>\n<pre><code class=\"language-xml\">&#x3C;intent-filter>\n    &#x3C;action android:name=\"android.intent.action.VIEW\"/>\n    &#x3C;category android:name=\"android.intent.category.DEFAULT\"/>\n    &#x3C;category android:name=\"android.intent.category.BROWSABLE\"/>\n    &#x3C;data android:scheme=\"app\" android:host=\"${deepLinkHost}\" />\n&#x3C;/intent-filter>\n</code></pre>\n<ul>\n<li>removing <code>SYSTEM_ALERT_WINDOW</code> permission from React Native based release builds (this seems quite hacky though; you can find the original issue <a href=\"https://stackoverflow.com/questions/45170025/cant-use-manifest-placeholders-to-remove-a-permission\">here (link)</a>)</li>\n</ul>\n<pre><code class=\"language-xml\">&#x3C;uses-permission android:name=\"${excludeDebugPermissionName}\" tools:node=\"remove\" />\n</code></pre>\n<pre><code class=\"language-groovy\">buildTypes {\n    release {\n        ...\n        manifestPlaceholders.excludeDebugPermissionName = \"android.permission.SYSTEM_ALERT_WINDOW\"\n    }\n    debug {\n        ...\n        manifestPlaceholders.excludeDebugPermissionName = \"fake.name\"\n    }\n}\n</code></pre>\n<p>But there are much more possibilities, e.g. I can think of an app that uses different launcher activities.</p>\n<p>Do you have any interesting experiences using the placeholders? Feel free to share with me in the comments :-)</p>","excerpt":"What are they? Android Manifest placeholders allow you to put variables into the Manifest that is otherwise completely static. Why would youâ€¦","frontmatter":{"slug":null,"title":"Android Manifest placeholders","description":null,"author":"azabost","tags":["android","gradle","manifest"],"date":"2018-01-24T23:00:00.000Z","image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#98c858","images":{"fallback":{"src":"/static/48f62a76ed11807e32a1e1117acb6660/c2d17/placeholder.png","srcSet":"/static/48f62a76ed11807e32a1e1117acb6660/2c67b/placeholder.png 200w,\n/static/48f62a76ed11807e32a1e1117acb6660/6addd/placeholder.png 400w,\n/static/48f62a76ed11807e32a1e1117acb6660/c2d17/placeholder.png 800w","sizes":"(min-width: 800px) 800px, 100vw"},"sources":[{"srcSet":"/static/48f62a76ed11807e32a1e1117acb6660/b5535/placeholder.webp 200w,\n/static/48f62a76ed11807e32a1e1117acb6660/f5c71/placeholder.webp 400w,\n/static/48f62a76ed11807e32a1e1117acb6660/0d27e/placeholder.webp 800w","type":"image/webp","sizes":"(min-width: 800px) 800px, 100vw"}]},"width":800,"height":600}}}},"timeToRead":4,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-01-25-android-manifest-placeholders.md"},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-01-25-android-manifest-placeholders.md"}},"staticQueryHashes":["2189233960","3181594896"]}