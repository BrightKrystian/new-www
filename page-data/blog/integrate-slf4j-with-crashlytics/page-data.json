{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/integrate-slf4j-with-crashlytics","result":{"data":{"markdownRemark":{"html":"<p>As I mentioned in my previous post having meaningful log entries comes handy during development. When an app reaches beta testers as well as goes live it's equally or even more important to be able to figure out why the app you've carefully coded isn't behaving as it should. Testing the app on all android flavours is literally impossible that's why getting an insight into what caused a crash is vital.</p>\n<h2><a href=\"https://dev.twitter.com/products/crashlytics\">Crashlytics</a></h2>\n<p>Error reporting providers are getting more and more popular. There are plenty of options to choose from: <a href=\"https://raygun.io/\">Raygun</a>, <a href=\"https://airbrake.io/\">Airbrake</a> and <a href=\"https://dev.twitter.com/products/crashlytics\">Crashlytics</a> are just frew examples. At <a href=\"http://brightinventions.pl/\">Bright Inventions</a> we use the last one and are more and more pleased with it. Setting it up is really easy - if you don't mind installing an IDE plugin it provides. Frankly I would prefer being able to configure a project with a simple command line tool but I understand a motivation behind it which is making the installation as seamless as possible.</p>\n<p>Crashlytics let's you not only report <a href=\"http://developer.android.com/reference/java/lang/Thread.html#setDefaultUncaughtExceptionHandler(java.lang.Thread.UncaughtExceptionHandler)\">uncaught exceptions</a> but also handled errors with additional information provided by log entries:</p>\n<pre><code class=\"language-java\">try {\n  Crashlytics.log(Log.INFO, \"HomeActivity\", \"Make request\");\n  makeRequest();\n}catch(RuntimeException ex){\n  Crashlytics.log(Log.ERROR, \"HomeActivity\", \"Error making request \" + ex);\n}\n</code></pre>\n<p>This will print messages to logcat as well as well as well as make them available in Crashlytics dashboard.</p>\n<h2>Using <a href=\"https://github.com/bright/slf4android\">slf4j</a> with Crashlytics</h2>\n<p>I've already explained why <a href=\"/introducing-slf4android/\">I don't like this approach to logging</a>. Thankfully with <a href=\"https://github.com/bright/slf4android\">slf4android</a> it's really easy to replace a default logcat appender with a <code>CrashlyticsLoggerHandler</code>:</p>\n<pre><code class=\"language-java\">public class CrashlyticsLoggerHandler extends Handler {\n  MessageValueSupplier messageValueSupplier = new MessageValueSupplier();\n\n  @Override\n  public void publish(java.util.logging.LogRecord record) {\n    LogRecord logRecord = pl.brightinventions.slf4android.LogRecord.fromRecord(record);\n    StringBuilder messageBuilder = new StringBuilder();\n    messageValueSupplier.append(logRecord, messageBuilder);\n    String tag = record.getLoggerName();\n    int androidLogLevel = logRecord.getLogLevel().getAndroidLevel();\n    Crashlytics.log(androidLogLevel, tag, messageBuilder.toString());\n  }\n\n  @Override\n  public void close() {}\n  @Override\n  public void flush() {}\n}\n</code></pre>\n<p>All that is left is to add the handler to root logger in your custom application <code>onCreate</code> method:</p>\n<pre><code class=\"language-java\">LoggerConfiguration.configuration()\n  .removeRootLogcatHandler()\n  .addHandlerToRootLogger(new CrashlyticsLoggerHandler());\n</code></pre>\n<p>From now on all log messages will go through Crashlytics API and couple of last log entries will be available next to crash report details in dashboard.</p>\n<p><em>This article is cross-posted with <a href=\"http://miensol.pl\">my personal blog</a></em></p>","excerpt":"As I mentioned in my previous post having meaningful log entries comes handy during development. When an app reaches beta testers as well asâ€¦","frontmatter":{"slug":null,"title":"Integrate slf4j with Crashlytics","description":null,"author":"piotr","tags":["android"],"date":"2014-11-20T21:00:00.000Z","image":null},"timeToRead":2,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2014-11-20-integrate-slf4j-with-crashlytics.md"},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2014-11-20-integrate-slf4j-with-crashlytics.md"}},"staticQueryHashes":["2189233960","3181594896"]}