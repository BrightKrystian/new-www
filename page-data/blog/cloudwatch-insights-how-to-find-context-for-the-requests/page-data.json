{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/cloudwatch-insights-how-to-find-context-for-the-requests","result":{"data":{"markdownRemark":{"html":"<p>Recently I was searching through our application logs. The task was to extract extra context for a group of requests (ex. errors in the external provider system with the original request). For our app, we are using <a href=\"https://aws.amazon.com/cloudwatch/\">CloudWatch</a> to store the logs. I have used <a href=\"https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/AnalyzingLogData.html\">CloudWatch Insights</a> as out of the box tool to analyze them. </p>\n<p>Our logs have a format like below, with each console output in a separate line: </p>\n<pre><code>2021-02-06T13:38:31.730Z info [some request id 1; some user id 1] Some external provider error message\n2021-02-06T14:21:00.000Z info [some request id 2; some user id 2] Some external provider error message\n</code></pre>\n<p>We can use Cloudwatch Insights to extract all the information related to that requests: </p>\n<pre><code>filter @message like \"Some context to error message log\"\n| parse @message \"* * [* *] *\" as timestamp,type,requestId, user, textMessage\n| filter requestId in [\"some request id 1;\", \"some request id 2\"]\n| sort @ingestionTime desc\n</code></pre>\n<p>If the field you are searching for is a JSON array, you can search it like: </p>\n<pre><code>filter @message like \"Some context to error message log {\n    \"someInfo\": [\n        some1,\n        some2\n    ]\n}\"\n| parse @message \"* * [* *] *\" as timestamp,type,requestId, user, textMessage\n| parse textMessage '\"someInfo\":[*]' as someInfo\n| filter requestId in [\"some request id 1;\", \"some request id 2\"]\n| sort @ingestionTime desc\n</code></pre>\n<p>You can then export the data that you need or build some stats around it. </p>\n<p>Let me know in the comments if you found CloudWatch Insights useful too and how you are using them. </p>","excerpt":"Recently I was searching through our application logs. The task was to extract extra context for a group of requests (ex. errors in theâ€¦","frontmatter":{"slug":null,"title":"CloudWatch Insights - how to find context of multiple requests?","description":null,"author":"rafal h","tags":["tips&tricks","aws","cloudwatch","logs"],"date":"2021-05-05T15:22:52.864Z","image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/56d1c7548a17f5af06c6769ad4b152c8/c5afe/joan-gamell-xu1l22iuknc-unsplash.jpg","srcSet":"/static/56d1c7548a17f5af06c6769ad4b152c8/3fbbf/joan-gamell-xu1l22iuknc-unsplash.jpg 1504w,\n/static/56d1c7548a17f5af06c6769ad4b152c8/9e626/joan-gamell-xu1l22iuknc-unsplash.jpg 3008w,\n/static/56d1c7548a17f5af06c6769ad4b152c8/c5afe/joan-gamell-xu1l22iuknc-unsplash.jpg 6015w","sizes":"(min-width: 6015px) 6015px, 100vw"},"sources":[{"srcSet":"/static/56d1c7548a17f5af06c6769ad4b152c8/bf208/joan-gamell-xu1l22iuknc-unsplash.webp 1504w,\n/static/56d1c7548a17f5af06c6769ad4b152c8/964c2/joan-gamell-xu1l22iuknc-unsplash.webp 3008w,\n/static/56d1c7548a17f5af06c6769ad4b152c8/a8cb1/joan-gamell-xu1l22iuknc-unsplash.webp 6015w","type":"image/webp","sizes":"(min-width: 6015px) 6015px, 100vw"}]},"width":6015,"height":4010}}}},"timeToRead":1,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2021-05-05-cloudwatch-insights-how-to-find-context-for-the-requests.md"},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2021-05-05-cloudwatch-insights-how-to-find-context-for-the-requests.md"}},"staticQueryHashes":["2189233960","3181594896"]}