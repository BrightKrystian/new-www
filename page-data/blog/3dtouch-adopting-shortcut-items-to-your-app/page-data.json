{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/3dtouch-adopting-shortcut-items-to-your-app","result":{"data":{"markdownRemark":{"html":"<p>With the beginning of the iPhone 6s, Apple has introduced a 3D Touch mechanism which is very cool thing. The 3D Touch is also available on\nthe newest iPhones 7. Nothing indicates that in the future Apple devices will run out of that feature so, here is a quick tutorial on how\nto improve your app using the one of the three main features of 3D Touch.</p>\n<p><img src=\"https://static.pexels.com/photos/50603/iphone-6-apple-ios-iphone-50603.jpeg\"></p>\n<h1>Modify your Info.plist file</h1>\n<ol>\n<li>Add to your  <code>Info.plist</code> file a special key called <code>UIApplicationShortcutItems</code>. It should be an array.</li>\n<li>Add items to <code>UIApplicationShortcutItems</code> array. Items should be a dictionary type.</li>\n<li>Put info for each item.</li>\n</ol>\n<p>  There are few values to set here.</p>\n<pre><code>  - UIApplicationShortcutItemType (required)\n  - UIApplicationShortcutItemTitle (required)\n  - UIApplicationShortcutItemSubtitle\n  - UIApplicationShortcutItemIconType\n  - UIApplicationShortcutItemIconFile\n  - UIApplicationShortcutItemUserInfo\n</code></pre>\n<p>  I will focus on the values that I set in my example app. The <code>UIApplicationShortcutItemType</code> is a string that delivers an information to your app about what type of shortcut was pressed.\n<code>UIApplicationShortcutItemTitle</code> is what user sees when the shortcut is shown. <code>UIApplicationShortcutItemIconType</code> is a string that inform application what kind of <strong><em>system</em></strong>  icon should be used for this shortcut.\nAnd the last one is <code>UIApplicationShortcutItemIconFile</code> defining the icon name that should be shown when the shortcut appears(instead of system icon).</p>\n<blockquote>\n<p>Important thing here is that you can use system <strong><em>or</em></strong> your custom icons. Apple recommends that the custom icon should be square, single color, and 35x35 points.</p>\n</blockquote>\n<p>  More about <code>UIApplicationShortcutItems</code> keys and description you can get from <a href=\"https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW1\">Apple documentation</a>.</p>\n<p>  The configured <code>Info.plist</code> could look like that:</p>\n<p>  <img src=\"https://raw.githubusercontent.com/kamwysoc/kamwysoc.github.io/master/assets/posts/3dTouch/info-plist.png\"></p>\n<p>  and by code:</p>\n<pre><code class=\"language-xml\">&#x3C;key>UIApplicationShortcutItems&#x3C;/key>\n&#x3C;array>\n    &#x3C;dict>\n        &#x3C;key>UIApplicationShortcutItemType&#x3C;/key>\n        &#x3C;string>app.some_another_action&#x3C;/string>\n        &#x3C;key>UIApplicationShortcutItemTitle&#x3C;/key>\n        &#x3C;string>Title with custom icon&#x3C;/string>\n        &#x3C;key>UIApplicationShortcutItemIconFile&#x3C;/key>\n        &#x3C;string>apple-35&#x3C;/string>\n    &#x3C;/dict>\n    &#x3C;dict>\n        &#x3C;key>UIApplicationShortcutItemType&#x3C;/key>\n        &#x3C;string>app.some_action&#x3C;/string>\n        &#x3C;key>UIApplicationShortcutItemIconType&#x3C;/key>\n        &#x3C;string>UIApplicationShortcutIconTypeAdd&#x3C;/string>\n        &#x3C;key>UIApplicationShortcutItemTitle&#x3C;/key>\n        &#x3C;string>Title with system icon&#x3C;/string>\n    &#x3C;/dict>\n&#x3C;/array>\n</code></pre>\n<p><strong><em>Final result</em></strong></p>\n<p>Below you can see the result of above implementation.</p>\n<p><img src=\"https://raw.githubusercontent.com/kamwysoc/kamwysoc.github.io/master/assets/posts/3dTouch/custom_system_icon.gif\"></p>\n<h1>Application shortcut tap handling</h1>\n<p>Ok, now move to <code>AppDelegate</code> class and let's deal with the application's shortcut tap events.</p>\n<h4>1.Override and implement <code>UIApplicationDelegate</code> method.</h4>\n<p>Let's focus on this method:</p>\n<pre><code class=\"language-swift\">func application(_ application: UIApplication, performActionFor shortcutItem: UIApplicationShortcutItem, completionHandler: @escaping (Bool) -> Swift.Void)\n</code></pre>\n<p>That method is called every time when the application shortcut is pressed. You don't have to worry about your application state. If your app is in background mode it just wakes up your app and triggers <code>performActionFor</code> method. But if the application is terminated the app cycle will be <code>didLauchWithOptions</code> and then <code>performActionFor shortcutItem</code> will be called.\nOf course, you can take the application shortcut in <code>didLauchWithOptions</code> method by:</p>\n<pre><code class=\"language-swift\">if let shortcutItem = launchOptions?[UIApplicationLaunchOptionsShortcutItemKey] as? UIApplicationShortcutItem {\n  //deal with it here\n}\n</code></pre>\n<p>before it triggers the <code>performActionFor</code> method.</p>\n<h4>2.Handling the <code>UIApplicationShortcutItem</code></h4>\n<p>It's time to write some code here. So let's assume that your <code>AppDelegate</code> class includes these two methods:</p>\n<pre><code class=\"language-swift\">func application(_ application: UIApplication, performActionFor shortcutItem: UIApplicationShortcutItem, completionHandler: @escaping (Bool) -> Swift.Void) {\n    handleShortcut(shortcutItem)\n}\n\nprivate func handleShortcut(_ item: UIApplicationShortcutItem) {\n\n}\n</code></pre>\n<p>Did you remember the <code>UIApplicationShortcutItemType</code>? Value for this key is very useful to identify what application shortcut was tapped.\nBut on the <code>Info.plist</code> file it occurs as a <code>String</code> type and I strongly advise against comparing the string in their pure form.\nVery helpful here might be <code>Enum</code> type. So create the enum.</p>\n<pre><code class=\"language-swift\">enum ApplicationShortcutTypes: String {\n    case redApple = \"show-red-apple\"\n    case greenApple = \"show-green-apple\"\n}\n</code></pre>\n<p>I think comparing types using enum is a much better way to identify what type of shortcut was tapped.</p>\n<p>Now get back to the <code>handleShortcut</code> method:</p>\n<pre><code class=\"language-swift\">private func handleShortcut(_ item: UIApplicationShortcutItem) {\n    guard let actionType = ApplicationShortcutTypes(rawValue: item.type) else {\n        return\n    }\n    switch (actionType) {\n    case .greenApple:\n      showGreenAppleViewController()\n    case .redApple:\n      showRedAppleViewController()\n    }\n}\n</code></pre>\n<p>The effect of implementation will look like this:</p>\n<p><img src=\"https://raw.githubusercontent.com/kamwysoc/kamwysoc.github.io/master/assets/posts/3dTouch/working_app.gif\"></p>\n<p>As you can see above I create two quick actions with custom icon, title and subtitle.</p>\n<h1>Dynamic shortcut items</h1>\n<p>It is worth to mention about dynamic shortcut items. Yes, UIApplicationShortcutItems are split between <code>static</code> and <code>dynamic</code>.</p>\n<ul>\n<li>static - that items are placed in <code>info.plist</code></li>\n<li>dynamic - that items can be added and removed in code</li>\n</ul>\n<p>To add dynamic shortcut item you just have to add it to <code>shortcutItems</code> array.</p>\n<pre><code>UIApplication.sharedApplication().shortcutItems?.append(UIMutableApplicationShortcutItem(type: \"my-dynamic-shortcut\", localizedTitle: \"Dynamic shortcut\"))\n</code></pre>\n<p>to remove:</p>\n<pre><code class=\"language-swift\">if let shortcutItem = UIApplication.sharedApplication().shortcutItems?.filter({ $0.type == \"my-dynamic-shortcut\" }).first {\n    guard let index = UIApplication.sharedApplication().shortcutItems?.indexOf(shortcutItem) else {\n      return\n    }\n    UIApplication.sharedApplication().shortcutItems?.removeAtIndex(index)\n}\n</code></pre>\n<h1>Conclusion</h1>\n<p>The 3D Touch is powerful feature and makes iOS apps very nice to use. Interesting fact is that from the iOS 10 all apps available on AppStore have predefined <code>Share App</code> shortcut. It allows us to share the applications without opening them. In my future posts I will describe more features that 3d touch gives us. So, thanks for reading and see you next time!</p>\n<p><img src=\"https://raw.githubusercontent.com/kamwysoc/kamwysoc.github.io/master/assets/posts/3dTouch/share_app.gif\"></p>\n<p><em>This post is cross-posted with my personal <a href=\"https://wysockikamil.com/3dtouch-adopting-shortcut-items-to-your-app/\">blog</a></em></p>","excerpt":"With the beginning of the iPhone 6s, Apple has introduced a 3D Touch mechanism which is very cool thing. The 3D Touch is also available onâ€¦","frontmatter":{"slug":null,"title":"3D Touch - Adopting shortcut items to your app.","description":null,"author":"kwysocki","tags":["iOS","swift","3d touch"],"date":"2016-11-26T23:00:00.000Z","image":null},"timeToRead":5,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2016-11-27-3dtouch-adopting-shortcut-items-to-your-app.md"},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2016-11-27-3dtouch-adopting-shortcut-items-to-your-app.md"}},"staticQueryHashes":["2189233960","3181594896"]}